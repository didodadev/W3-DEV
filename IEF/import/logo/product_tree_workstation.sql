/* Ürün Ağacı İstasyon Tanımı Aktarım
settings.form_add_workstation_import */
DECLARE @SQLString NVARCHAR(max)
SET @SQLString = N'select 

		ITEMS.CODE as StokKodu,
		OPERTION.CODE as OperasyonKodu,
		CASE WHEN BOMLINE.LINETYPE=4 THEN 0 ELSE 
		(SELECT ITEMREF FROM LG_'+@FirmNr+'_BOMLINE A WHERE A.BOMREVREF=BOMREVSN.LOGICALREF AND A.LINETYPE=4 )END as BaglıOlduguÜrünİçinStokKodu,
		OPRTREQ.WSREF İstasyonID,
		(OPRTREQ.OCCSLICETIME/65536/256) as KapasiteSaat,
		(OPRTREQ.FIXEDSETUPTIME/65536/256)*60  as SetupDk,
		(OPRTREQ.RUNTIME/65536/256)*60  as ÜretimZamanıDk,
		OPRTREQ.MINAMOUNT as MinimumÜretimMiktarı,
		0 as Tip,
		0 as FizikiVarlık

		from  LG_'+@FirmNr+'_ITEMS AS ITEMS INNER JOIN
			   LG_'+@FirmNr+'_BOMLINE AS BOMLINE ON ITEMS.LOGICALREF = BOMLINE.ITEMREF INNER JOIN
			   LG_'+@FirmNr+'_BOMREVSN AS BOMREVSN ON BOMLINE.BOMREVREF = BOMREVSN.LOGICALREF LEFT OUTER JOIN
			   LG_'+@FirmNr+'_OPERTION OPERTION ON BOMLINE.OPERATIONREF=OPERTION.LOGICALREF  LEFT OUTER JOIN
			   LG_'+@FirmNr+'_OPRTREQ OPRTREQ on OPRTREQ.OPERATIONREF=OPERTION.LOGICALREF'
EXECUTE sp_executesql @SQLString
 
 