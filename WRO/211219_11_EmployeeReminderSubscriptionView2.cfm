<!-- Description :Employee Remainder View ler düzenlendi
Developer: Pınar Yıldız
Company : Workcube
Destination: Period -->
<querytag>
        CREATE VIEW [EMPLOYEE_REMAINDER_SUBSCRIPTION] AS
			SELECT
				EMPLOYEE_ID, 
				SUBSCRIPTION_ID,
				SUM(BORC-ALACAK) AS BAKIYE, 
				SUM(BORC) AS BORC,
				SUM(BORC2) AS BORC2,
				SUM(ALACAK) AS ALACAK,
				SUM(ALACAK2) AS ALACAK2,
				CASE WHEN SUM(BORC)= 0 THEN SUM((BORC*DATE_DIFF)) ELSE ROUND((SUM((BORC*DATE_DIFF))/SUM(BORC)),0) END AS VADE_BORC,
				CASE WHEN SUM(ALACAK)= 0 THEN SUM((ALACAK*DATE_DIFF)) ELSE ROUND((SUM((ALACAK*DATE_DIFF))/SUM(ALACAK)),0) END AS VADE_ALACAK,
				ACC_TYPE_ID
			FROM
				CARI_ROWS_EMPLOYEE
			GROUP BY
				EMPLOYEE_ID,
				SUBSCRIPTION_ID,
				ACC_TYPE_ID
</querytag>